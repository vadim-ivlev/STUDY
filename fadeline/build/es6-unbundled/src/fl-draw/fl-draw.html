<html><head><link rel="import" href="../../bower_components/polymer/polymer-element.html"><link rel="import" href="./fl-draw-style.html"><script src="../../node_modules/jquery/dist/jquery.min.js"></script><script src="../../node_modules/pressure/dist/jquery.pressure.min.js"></script><script src="../../node_modules/p5/lib/p5.min.js"></script><script src="./js/jquery.event.move.js"></script><script src="./src/flsketch.js"></script></head><body><dom-module id="fl-draw"><template><style include="fl-draw-style"></style><div id="pane" class="noselect"></div></template><script>let pane,dpane,flSketchRet;const points=[];class FlDraw extends Polymer.Element{static get is(){return"fl-draw"}static get properties(){return{flow:{type:Number,value:255,notify:!0},width:{type:Number,value:400,notify:!0},height:{type:Number,value:300,notify:!0},size:{type:Number,value:3,notify:!0},color:{type:String,value:"#F00",notify:!0},flowP:{type:Number,reflectToAttribute:!1,computed:"computeFlowP(flow)"}}}computeFlowP(a){return 100*a/255}ready(){super.ready(),pane=$("#pane",this.shadowRoot),dpane=this.shadowRoot.getElementById("pane"),dpane.style.width=`${this.width}px`,dpane.style.height=`${this.height}px`,flSketchRet=FlSketch(dpane,this.width,this.height,points),attachEventHandlers(this.shadowRoot)}}window.customElements.define(FlDraw.is,FlDraw);let pointerDown=!1,press=0;function pushPoint(a,b){fixOffsets(a);let c={action:b,eventType:a.type,x:a.offsetX,y:a.offsetY,pressure:press,time:Date.now()};points.push(c)}function mouseover_handler(a){a.buttons&&(pointerDown=!0),pushPoint(a,"mouseover")}function mouseout_handler(a){pointerDown=!1,pushPoint(a,"mouseout")}function movestart_handler(a){pointerDown=!0,pushPoint(a,"movestart")}function moveend_handler(a={type:"up"}){pointerDown=!1,pushPoint(a,"moveend")}function move_handler(a){pointerDown&&pushPoint(a,"move")}function fixOffsets(a){if(!(a.offsetX||a.offsetY)){let b=pane.offset();a.offsetX=(a.pageX||0)-b.left,a.offsetY=(a.pageY||0)-b.top}}function attachEventHandlers(a){pane=$("#pane",a),pane.on("touchmove",(a)=>a.preventDefault()),$("#pane",a).pressure({change:(a)=>{press=a},start:function(){},end:function(){}},{preventSelect:!0,polyfillSpeedUp:300}),pane.on("mouseover",mouseover_handler),pane.on("mouseout",mouseout_handler),pane.on("mousedown",movestart_handler),pane.on("mouseup",moveend_handler),pane.on("mousemove",move_handler)}</script></dom-module></body></html>